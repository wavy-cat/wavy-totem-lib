---
title: Как сгенерировать тотем?
description: Изучите как генерировать тотемы при помощи билдера
---

import { Steps } from '@astrojs/starlight/components';

Для генерации тотемов используются несколько ключевых компонентов:

1. Ваш скин, в виде экземпляра класса [Skin](/ru/concepts/skin);
2. Алгоритм, который будет рисовать тотем, т.е. [паттерн](/ru/concepts/pattern/). По-умолчанию используется [Wavy](/ru/concepts/pattern#wavy);
3. [Билдер](/ru/concepts/builder), который соединит два предыдущих компонента вместе и вернёт [тотем](/ru/concepts/totem).

## Пошаговая инструкция

<Steps>

1. Cоздайте экземпляр класса Skin на основе вашего скина:

    ```py
    from wavy_totem_lib import Skin

    skin = Skin(
        # Указываем из какого файла брать скин.
        # Вы также можете передать напрямую bytes
        'my_skin.png',

        # Принудительно указываем, что скин узкий
        slim=True
    )
    ```

2. Создайте билдер тотема:

    ```py
    from wavy_totem_lib import TotemBuilder, WavyStyle, ALL_TOP_LAYERS

    builder = TotemBuilder(
        # Передайте экземпляр скина, который вы создали ранее.
        skin,
    )
    ```

    Билдер принимает несколько опциональных аргументов, которые влияют на конечную текстуру тотема. Подробнее читайте на [странице билдера](/ru/concepts/builder), в разделе концепций.

3. Используйте метод `.build()` для создания тотема:

    ```py
    totem = builder.build()
    ```

    Метод принимает дополнительные **kwargs аргументы, которые передаются паттерну.
    Вы можете их передать, если используемый паттерн умеет их обрабатывать.
    Все встроенные в библиотеку паттерны не используют доп. аргументы.

    В асинхронной функции вы можете использовать асинхронный метод `.build_async()`:

    ```py
    totem = await builder.build_async()
    ```

</Steps>

После этих действий вы получите экземпляр класса [Totem](/ru/concepts/totem), который содержит объект PIL.Image в свойстве `image`.
Вы можете работать с ним как с обычным изображением Pillow. Например, сохранить его:

```py
totem.image.save('my_totem.png')
```

## Масштабирование тотема

Суть масштабирования заключается в том, чтобы сделать из одного пикселя несколько пикселей, образовав квадрат из одинаковых по цвету пикселей в N раз больше реального.
При помощи этой манипуляции можно избежать эффекта размытия в браузерах, мессенджера и в других программах, где есть просмотр изображения.

Для масштабирования используйте метод `.scale()` у типа Totem.

```py
n = 2  # Множитель масштабирования. В данном случае увеличение в 2 раза
scaled_img = totem.scale(factor=n)  # factor является ключевым аргументом
```

Метод возвращает тип PIL.Image, поэтому вы можете работать с ним как с обычным изображением Pillow, так же как вы работали со свойством тотема `image`.

## Выбор верхнего слоя

Для обозначения частей тела верхнего (aka второго) слоя используется Enum тип `TopLayer`:

* `HEAD` — голова;
* `TORSO` — тело;
* `HANDS` — руки;
* `LEGS` — ноги.

Эти значения передаются в виде списка в билдер и в паттерн.
Для удобства в библиотеке есть константа `ALL_TOP_LAYERS`, которая содержит все части тела.

### Примеры

```py
from wavy_totem_lib import TotemBuilder, ALL_TOP_LAYERS, TopLayer

builder = TotemBuilder(
    skin,
    top_layers=[TopLayer.HEAD, TopLayer.HANDS]  # Только голова и руки верхнего слоя будут отрисованы
)

builder = TotemBuilder(
    skin,
    top_layers=ALL_TOP_LAYERS  # Все части тела верхнего слоя будут отрисованы.
    # ALL_TOP_LAYERS уже является значением по-умолчанию для аргумента top_layers,
    # поэтому вы можете не указывать его вовсе.
)
```
